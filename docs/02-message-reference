## Message Type Reference

### Session Management

| Type | Message | Direction | Response |
|------|---------|-----------|----------|
| VDSM_REQUEST_HELLO | vdsm_RequestHello | vdSM → vDC | vdc_ResponseHello |
| VDC_RESPONSE_HELLO | vdc_ResponseHello | vDC → vdSM | N/A |
| VDSM_SEND_BYE | vdsm_SendBye | vdSM → vDC | None |

#### vdsm_RequestHello 

| Request Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the vdSM |
| api_version | integer | vDC API version — The API version as described in this document is 2 |

#### vdc_ResponseHello 

| Response Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the vDC host. Note: although the vDC host may not appear as a logical entity in other specs yet, it still has a dSUID to be addressable. |

Error Case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | RESULT_SERVICE_NOT_AVAILABLE: vDC host cannot accept the connection because it is already connected to another vdSM. RESULT_INCOMPATIBLE_API: vdSM does not support the API version presented in api_version. |
| message | string | explanation text |

#### vdsm_SendBye (vdSM → vDC)

| Request Parameter | Type | Description |
|---|---:|---|
| - | - | - |

Error Case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | 0 - success |

---

### Property Access

| Type | Message | Direction | Response |
|------|---------|-----------|----------|
| VDSM_REQUEST_GET_PROPERTY | vdsm_RequestGetProperty | vdSM → vDC | vdc_ResponseGetProperty |
| VDC_RESPONSE_GET_PROPERTY | vdc_ResponseGetProperty | vDC → vdSM | N/A |
| VDSM_REQUEST_SET_PROPERTY | vdsm_RequestSetProperty | vdSM → vDC | GenericResponse |
| VDC_SEND_PUSH_PROPERTY | vdc_SendPushProperty | vDC → vdSM | Error only |
| VDC_SEND_PUSH_NOTIFICATION | vdc_SendPushNotification | vDC → vdSM | Error only |

#### vdsm_RequestGetProperty

| Request Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the entity (device, vDC or vDC host) to read properties from |
| query | property elements sub-messages | A property tree structure consisting of property element names (no values) specifying which properties to return. Empty element name acts as a wildcard for that level; if the wildcard is the last element on a branch, deeper levels are returned too. |

#### vdc_ResponseGetProperty

| Response Parameter | Type | Description |
|---|---:|---|
| properties | property elements sub-messages | A property tree with property elements and values matching the query. Wildcards expand to return substructures; unknown properties are omitted; existing properties with no value return explicit NULL. |

Error case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | RESULT_FORBIDDEN: the property exists but cannot be read (write-only, uncommon case). |
| message | string | explanation text |

#### vdsm_RequestSetProperty
Request

| Request Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the entity to write properties to |
| properties | property elements sub-messages | Property tree with values to write. Empty element name can act as wildcard to set all elements on that level to the same value. Notes: channelState must not be changed by setProperty (use setOutputChannelValue). If multiple values are written in one request and one fails, setProperty returns an error; other values may already have been stored. |

Response: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | 0 - success |

Error case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | RESULT_INVALID_VALUE_TYPE: passed type is wrong and cannot be written. RESULT_FORBIDDEN: property exists but cannot be read/write. RESULT_NOT_FOUND: the receiver specified through dSUID is unknown at the callee. |
| message | string | explanation text (optional) |

#### vdc_SendPushProperty — pushProperty (vDC → vdSM)
Notification

| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the entity (device, vDC or vDC host) from where this notification originates |
| properties | property elements sub-messages | Property tree with elements and values representing the information pushed to the vdSM. |

---

### Device Lifecycle

| Type | Message | Direction | Response |
|------|---------|-----------|----------|
| VDC_SEND_ANNOUNCE_VDC | vdc_SendAnnounceVdc | vDC → vdSM | Error only |
| VDC_SEND_ANNOUNCE_DEVICE | vdc_SendAnnounceDevice | vDC → vdSM | Error only |
| VDC_SEND_VANISH | vdc_SendVanish | vDC → vdSM | Error only |
| VDSM_SEND_REMOVE | vdsm_SendRemove | vdSM → vDC | None |
| VDC_SEND_IDENTIFY | vdc_SendIdentify | vDC → vdSM | Error only |

#### vdc_SendAnnounceVdc — announcevdc (vDC → vdSM)
Request

| Request Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the vDC to be announced |

Response: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | 0 - success |

Error case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | RESULT_INSUFFICIENT_STORAGE: vdSM cannot handle another vDC |
| description | string | explanation text |
| errorType | enum | kind of failure with implication to error recovery |
| userMessageToBeTranslated | string | message suitable to be shown in UIs, translated by dSS |

#### vdc_SendAnnounceDevice — announcedevice (vDC → vdSM)
Request

| Request Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the device to be announced |
| vdc_dSUID | string of 34 hex characters (2*17) | dSUID of the logical vDC which contains this device |

Response: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | 0 - success |

Error case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | RESULT_INSUFFICIENT_STORAGE: vdSM cannot handle another device |
| message | string | explanation text |

#### vdc_SendVanish — vanish (vDC → vdSM)
Notification (device vanished)

| Field | Type | Description |
|---|---:|---|
| code | string of 34 hex characters (2*17) | The dSUID of the device that has vanished |

#### vdsm_SendRemove — remove (vdSM → vDC)
Request

| Request Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the device to be removed |

Response: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | 0 - success |

Error case: GenericResponse

| Field | Type | Description |
|---|---:|---|
| code | integer | RESULT_FORBIDDEN: vDC does not allow removal because the device is verifiably connected; note that wireless devices might be carried away and paired with another vDC — vDC must not reject deletion attempts in such cases. |
| message | string | explanation text |

#### vdc_SendIdentify — vdc_SendIdentify (vDC → vdSM)
Notification / Response only on error

| Field | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the device or entity to identify (sent from vDC to vdSM) |

---

### Keep-Alive

| Type | Message | Direction | Response |
|------|---------|-----------|----------|
| VDSM_SEND_PING | vdsm_SendPing | vdSM → vDC | vdc_SendPong |
| VDC_SEND_PONG | vdc_SendPong | vDC → vdSM | N/A |

#### vdsm_SendPing — ping (vdSM → vDC)
Notification

| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the entity (device, vDC or vDC host) to send the ping to |

#### vdc_SendPong — pong (vDC → vdSM)
Notification

| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | dSUID of the entity from where this pong originates |

---

### Notifications (Scene Operations)

All notifications listed here are vdSM → vDC unless otherwise stated. No response expected unless stated.

| Type | Message | Purpose |
|------|---------|---------|
| VDSM_NOTIFICATION_CALL_SCENE | vdsm_NotificationCallScene | Activate scene |
| VDSM_NOTIFICATION_SAVE_SCENE | vdsm_NotificationSaveScene | Save current state as scene |
| VDSM_NOTIFICATION_UNDO_SCENE | vdsm_NotificationUndoScene | Undo scene |
| VDSM_NOTIFICATION_SET_LOCAL_PRIO | vdsm_NotificationSetLocalPrio | Set local priority |
| VDSM_NOTIFICATION_CALL_MIN_SCENE | vdsm_NotificationCallMinScene | Call minimum scene |
| VDSM_NOTIFICATION_IDENTIFY | vdsm_NotificationIdentify | Identify device(s) |
| VDSM_NOTIFICATION_SET_CONTROL_VALUE | vdsm_NotificationSetControlValue | Set control value |
| VDSM_NOTIFICATION_DIM_CHANNEL | vdsm_NotificationDimChannel | Dim channel |
| VDSM_NOTIFICATION_SET_OUTPUT_CHANNEL_VALUE | vdsm_NotificationSetOutputChannelValue | Set channel value |

#### vdsm_NotificationCallScene — callScene (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs of device(s) this call applies to |
| scene | integer | dS scene number to call |
| force | boolean | if true, local priority is overridden |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationSaveScene — saveScene (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs of device(s) this call applies to |
| scene | integer | dS scene number to save state into |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationUndoScene — undoScene (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs of device(s) this call applies to |
| scene | integer | The scene call to undo. Undo executed only if device's last called scene matches this scene |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationSetLocalPrio — setLocalPriority (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs this call applies to |
| scene | integer | Scene to check for dontCare flag; if not set, localPriority is set on device |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationCallMinScene — callSceneMin (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs this call applies to |
| scene | integer | Scene to check for dontCare flag; if not set and device is off, min output is set |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationIdentify — Identify (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs this call applies to |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationSetControlValue — setControlValue (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs this call applies to |
| name | string | The name of the control value (semantic mapping; see vDC API properties) |
| value | double | control value (aka dS sensor value) |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationDimChannel — dimChannel (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs this call applies to |
| channel | integer | Channel to start/stop dimming (0 = default; 1..239 = channel) |
| mode | integer | 1 = start dim up; -1 = start dim down; 0 = stop dimming |
| area | integer | 0 = no area restriction; 1..4 = area-specific restriction |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

#### vdsm_NotificationSetOutputChannelValue — setOutputChannelValue (vdSM → vDC)
| Notification Parameter | Type | Description |
|---|---:|---|
| dSUID | string of 34 hex characters (2*17) | One or multiple dSIDs this call applies to |
| channel | integer | Channel index |
| apply_now | optional boolean | if omitted/false, new value buffered; apply when apply_now true |
| value | double | Value to be applied; may be omitted if automatic flag set |
| automatic | optional boolean | Switch to internal automatic control logic |
| group | optional integer | dS group number (informational only) |
| zoneID | optional integer | dS global zone ID number (informational only) |

---

### Generic Request (API v2c+)

| Type | Message | Direction | Response |
|------|---------|-----------|----------|
| VDSM_REQUEST_GENERIC_REQUEST | vdsm_RequestGenericRequest | vdSM → vDC | GenericResponse |

#### vdsm_RequestGenericRequest — GenericRequest (vdSM → vDC)
GenericRequest carries a method name and method-specific parameters. The vDC executes the requested operation and replies with GenericResponse (or error).

Common fields

| Request Field | Type | Description |
|---|---:|---|
| method | string | action to invoke (see examples below) |
| dSUID | string of 34 hex characters (2*17) | one or multiple dSUIDs the call applies to (if applicable) |
| params | optional | additional parameters as a JSON-encoded object |

Examples of GenericRequest method payloads (extracted from images):

- invokeDeviceAction (call action on device)
  - params: id (string) — device action to execute; additional params as JSON object
  - Example request parameters summary:
    | Parameter | Type | Description |
    |---|---:|---|
    | method | string | invokeDeviceAction |
    | dSUID | string of 34 hex characters | target device(s) |
    | id | string | action id |
    | params | optional | JSON object with parameters |

- pair (learn-in / learn-out)
  - method = "pair"
  - fields:
    | Parameter | Type | Description |
    |---|---:|---|
    | establish | bool | true = learn-in, false = learn-out |
    | timeout | integer | seconds, -1 to disable timeout |
    | params | optional | additional params as JSON |

- authenticate
  - method = "authenticate"
  - fields:
    | Parameter | Type | Description |
    |---|---:|---|
    | authData | string | JSON encoded auth tokens |
    | authScope | string | context (user id or device reference) |
    | params | optional | additional parameters |

- firmwareUpgrade
  - method = "firmwareUpgrade"
  - fields:
    | Parameter | Type | Description |
    |---|---:|---|
    | checkonly | bool | true for dry-run check only |
    | clearsettings | bool | true to reset configuration to factory defaults |
    | params | optional | additional parameters |

- setConfiguration
  - method = "setConfiguration"
  - fields:
    | Parameter | Type | Description |
    |---|---:|---|
    | id | string | New Configuration ID |

- identify (identify vDC host device)
  - method = "identify"
  - fields:
    | Parameter | Type | Description |
    |---|---:|---|
    | dSUID | string of 34 hex characters | dSUID(s) of the vDC to be identified |

Response: GenericResponse (common)

| Field | Type | Meaning |
|---|---:|---|
| code | integer or string | status / result code (semantics depend on call) |
| message | string | explanation text (optional) |

Error responses use result codes such as:
- RESULT_SERVICE_NOT_AVAILABLE
- RESULT_INCOMPATIBLE_API
- RESULT_INSUFFICIENT_STORAGE
- RESULT_FORBIDDEN
- RESULT_INVALID_VALUE_TYPE
- RESULT_NOT_FOUND
...and others described inline above.

---

End of file.
